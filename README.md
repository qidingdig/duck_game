# å”è€é¸­å°æ¸¸æˆ (Duck Game)

ä¸€ä¸ªåŸºäº Pygame çš„äº¤äº’å¼å°æ¸¸æˆï¼Œé›†æˆäº†çº¢åŒ…æ¸¸æˆã€AI å¯¹è¯å’Œä»£ç ç»Ÿè®¡åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ® **äº¤äº’å¼æ¸¸æˆç•Œé¢**ï¼šç‚¹å‡»å”è€é¸­å¼€å§‹å¯¹è¯
- ğŸ§§ **çº¢åŒ…æ¸¸æˆ**ï¼šå”å°é¸­ç§»åŠ¨æŠ¢çº¢åŒ…ï¼Œç»Ÿè®¡çº¢åŒ…æ•°é‡å’Œé‡‘é¢
- ğŸ¤– **AI å¯¹è¯**ï¼šåŸºäº Ollama çš„æ™ºèƒ½å¯¹è¯åŠŸèƒ½
- ğŸ“Š **ä»£ç ç»Ÿè®¡**ï¼šæ”¯æŒå¤šè¯­è¨€ä»£ç é‡ç»Ÿè®¡ï¼ŒåŒ…å«å¯è§†åŒ–å›¾è¡¨

## ç³»ç»Ÿè¦æ±‚

- Python 3.7 æˆ–æ›´é«˜ç‰ˆæœ¬
- Windows / macOS / Linux

## å®‰è£…æ­¥éª¤

### 1. å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®

```bash
cd duck_game
```

### 2. å®‰è£…ä¾èµ–

**æ–¹å¼ä¸€ï¼šä½¿ç”¨å®‰è£…è„šæœ¬ï¼ˆæ¨èï¼‰**

```bash
python setup.py
```

**æ–¹å¼äºŒï¼šæ‰‹åŠ¨å®‰è£…**

```bash
pip install -r requirements.txt
```

### 3. é…ç½® AI åŠŸèƒ½

å¦‚æœéœ€è¦ä½¿ç”¨ AI å¯¹è¯åŠŸèƒ½ï¼Œéœ€è¦å®‰è£…å¹¶é…ç½® Ollamaï¼š

1. è®¿é—® [Ollama å®˜ç½‘](https://ollama.ai/) ä¸‹è½½å¹¶å®‰è£…
2. å¯åŠ¨ Ollama æœåŠ¡ï¼š
   ```bash
   ollama serve
   ```
3. ä¸‹è½½ AI æ¨¡å‹ï¼š
   ```bash
   ollama pull deepseekr1:8b
   ```

> **æ³¨æ„**ï¼šå¦‚æœä¸é…ç½® Ollamaï¼ŒAI å¯¹è¯åŠŸèƒ½å°†ä¸å¯ç”¨ï¼Œä½†çº¢åŒ…æ¸¸æˆå’Œä»£ç ç»Ÿè®¡åŠŸèƒ½ä»ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚

## è¿è¡Œæ¸¸æˆ

```bash
python main.py
```

## ä½¿ç”¨è¯´æ˜

### å¯åŠ¨æ¸¸æˆ

è¿è¡Œ `python main.py` åï¼Œæ¸¸æˆçª—å£ä¼šè‡ªåŠ¨æ‰“å¼€ã€‚

### å¼€å§‹å¯¹è¯

ç‚¹å‡»æ¸¸æˆç•Œé¢ä¸­çš„**å”è€é¸­**ï¼Œä¼šå¼¹å‡ºå¯¹è¯çª—å£ã€‚

### å¯ç”¨å‘½ä»¤

åœ¨å¯¹è¯çª—å£ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š

- **`æˆ‘è¦æŠ¢çº¢åŒ…`** - å¯åŠ¨çº¢åŒ…æ¸¸æˆï¼ˆ30ç§’æ¸¸æˆæ—¶é—´ï¼‰
- **`æˆ‘è¦aié—®ç­”`** - å¼€å§‹ AI å¯¹è¯
- **`æˆ‘è¦ç»Ÿè®¡ä»£ç é‡`** - æ‰“å¼€ä»£ç ç»Ÿè®¡é…ç½®ç•Œé¢
- **`ç»Ÿè®¡ä»£ç : <ç›®å½•è·¯å¾„>`** - å¿«é€Ÿç»Ÿè®¡æŒ‡å®šç›®å½•çš„ä»£ç ï¼ˆä½¿ç”¨é»˜è®¤è®¾ç½®ï¼‰

### ä»£ç ç»Ÿè®¡åŠŸèƒ½

ä»£ç ç»Ÿè®¡æ”¯æŒä»¥ä¸‹ç‰¹æ€§ï¼š

- æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ˆPython, Java, C/C++, JavaScript ç­‰ï¼‰
- å¯é€‰æ‹©ç‰¹å®šè¯­è¨€è¿›è¡Œç»Ÿè®¡
- ç»Ÿè®¡ä»£ç è¡Œæ•°ã€æ³¨é‡Šè¡Œæ•°ã€ç©ºè¡Œæ•°
- æ”¯æŒ Python å’Œ C/C++ å‡½æ•°ç»Ÿè®¡
- ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨ï¼ˆæŸ±çŠ¶å›¾ã€é¥¼å›¾ã€å‡½æ•°é•¿åº¦ç›´æ–¹å›¾ï¼‰
- æ”¯æŒå¯¼å‡ºä¸º CSVã€JSONã€XLSX æ ¼å¼
- æ”¯æŒè¯­è¨€æ˜ç»†è¡¨æ˜¾ç¤ºå’Œå¯¼å‡º

## é¡¹ç›®ç»“æ„

```
duck_game/
â”œâ”€â”€ main.py                    # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ setup.py                   # å®‰è£…è„šæœ¬
â”œâ”€â”€ requirements.txt           # Python ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ README.md                  # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ assets/                    # èµ„æºæ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ images/               # å›¾ç‰‡èµ„æº
â”‚   â””â”€â”€ sounds/               # éŸ³é¢‘èµ„æº
â”œâ”€â”€ core/                      # æ ¸å¿ƒç³»ç»Ÿå±‚ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ game_state.py         # æ¸¸æˆçŠ¶æ€ç®¡ç†å™¨ï¼ˆçŠ¶æ€æœºï¼‰
â”‚   â”œâ”€â”€ event_system.py        # äº‹ä»¶ç³»ç»Ÿï¼ˆè§‚å¯Ÿè€…æ¨¡å¼ï¼‰
â”‚   â”œâ”€â”€ render_system.py       # æ¸²æŸ“ç³»ç»Ÿï¼ˆåˆ†å±‚æ¸²æŸ“ï¼‰
â”‚   â””â”€â”€ physics_system.py     # ç‰©ç†ç³»ç»Ÿï¼ˆç¢°æ’æ£€æµ‹ã€ç§»åŠ¨ï¼‰
â”œâ”€â”€ game/                      # æ¸¸æˆé€»è¾‘å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ duck_game.py          # æ¸¸æˆä¸»ç±»
â”‚   â”œâ”€â”€ characters.py         # è§’è‰²ç±»
â”‚   â”œâ”€â”€ red_packet.py         # çº¢åŒ…æ¸¸æˆé€»è¾‘ï¼ˆæ—§ç‰ˆï¼Œä¿ç•™å…¼å®¹ï¼‰
â”‚   â””â”€â”€ minigames/            # å°æ¸¸æˆæ¨¡å—ï¼ˆæ–°å¢ï¼‰
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ base_minigame.py  # å°æ¸¸æˆåŸºç±»
â”‚       â””â”€â”€ red_packet_game/  # çº¢åŒ…æ¸¸æˆæ¨¡å—ï¼ˆç»†åŒ–ï¼‰
â”‚           â”œâ”€â”€ __init__.py
â”‚           â”œâ”€â”€ game_manager.py      # æ¸¸æˆç®¡ç†å™¨
â”‚           â”œâ”€â”€ red_packet.py        # çº¢åŒ…å®ä½“
â”‚           â”œâ”€â”€ spawner.py           # çº¢åŒ…ç”Ÿæˆå™¨
â”‚           â”œâ”€â”€ collision_detector.py  # ç¢°æ’æ£€æµ‹
â”‚           â”œâ”€â”€ movement_controller.py  # ç§»åŠ¨æ§åˆ¶
â”‚           â”œâ”€â”€ statistics.py        # ç»Ÿè®¡æ”¶é›†å™¨
â”‚           â””â”€â”€ renderer.py          # æ¸²æŸ“å™¨
â”œâ”€â”€ ui/                        # UIå±‚ï¼ˆæ–°å¢ï¼Œé€æ­¥å®Œå–„ï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ ...                    # UIæ¨¡å—ï¼ˆé€æ­¥è¿ç§»ï¼‰
â”œâ”€â”€ services/                  # æœåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ ai_service.py         # AI æœåŠ¡
â”‚   â”œâ”€â”€ advanced_code_counter.py  # ä»£ç ç»Ÿè®¡æœåŠ¡ï¼ˆå¢å¼ºç‰ˆï¼‰
â”‚   â””â”€â”€ duck_behavior_manager.py  # å°é¸­è¡Œä¸ºç®¡ç†å™¨
â””â”€â”€ utils/                     # å·¥å…·æ¨¡å—
    â”œâ”€â”€ __init__.py
    â””â”€â”€ config.py             # é…ç½®ç®¡ç†
```

## æ¶æ„è®¾è®¡

### æ ¸å¿ƒç³»ç»Ÿå±‚ (core/)

æä¾›æ¸¸æˆçš„åŸºç¡€æ¶æ„ï¼Œé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼š

- **GameStateManager**: ç»Ÿä¸€ç®¡ç†æ¸¸æˆçŠ¶æ€ï¼Œä½¿ç”¨çŠ¶æ€æœºæ¨¡å¼
- **EventManager**: è§£è€¦æ¨¡å—é—´é€šä¿¡ï¼Œä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼
- **RenderSystem**: åˆ†å±‚æ¸²æŸ“ç®¡ç†ï¼Œæ”¯æŒå¤šæ¸²æŸ“å™¨
- **PhysicsSystem**: ç‰©ç†è®¡ç®—ï¼ˆç¢°æ’æ£€æµ‹ã€ç§»åŠ¨æ§åˆ¶ï¼‰

### æ¸¸æˆé€»è¾‘å±‚ (game/)

åŒ…å«æ¸¸æˆçš„æ ¸å¿ƒé€»è¾‘ï¼š

- **DuckGame**: æ¸¸æˆä¸»ç±»ï¼Œç®¡ç†æ¸¸æˆå¾ªç¯å’Œæ•´ä½“æµç¨‹
- **Characters**: è§’è‰²ç±»ï¼ˆå”è€é¸­ã€å°é¸­ç­‰ï¼‰
- **Minigames**: å°æ¸¸æˆæ¨¡å—ï¼Œé‡‡ç”¨åŸºç±»è®¾è®¡ï¼Œæ˜“äºæ‰©å±•

### æœåŠ¡å±‚ (services/)

æä¾›å„ç§ä¸šåŠ¡æœåŠ¡ï¼š

- **AIService**: AIå¯¹è¯æœåŠ¡
- **AdvancedCodeCounter**: ä»£ç ç»Ÿè®¡æœåŠ¡
- **DuckBehaviorManager**: å°é¸­è¡Œä¸ºç®¡ç†

### UIå±‚ (ui/)

ç®¡ç†ç”¨æˆ·ç•Œé¢ï¼ˆé€æ­¥é‡æ„ä¸­ï¼‰ï¼š

- å¯¹è¯æ¡†ç®¡ç†
- ä»£ç ç»Ÿè®¡UI
- çº¢åŒ…æ¸¸æˆUI
- AIå¯¹è¯UI
- å›¾è¡¨æ¸²æŸ“

## ä¾èµ–åŒ…

- `pygame >= 2.6.0` - æ¸¸æˆå¼•æ“
- `requests >= 2.31.0` - HTTP è¯·æ±‚ï¼ˆç”¨äºæ£€æŸ¥ Ollama æœåŠ¡çŠ¶æ€ï¼‰
- `numpy >= 1.24.3` - æ•°å€¼è®¡ç®—
- `pandas >= 2.0.3` - æ•°æ®å¤„ç†
- `matplotlib >= 3.7.2` - æ•°æ®å¯è§†åŒ–
- `openpyxl >= 3.1.0` - Excelæ–‡ä»¶å¤„ç†
- `pyttsx3 >= 2.90` - æœ¬åœ°è¯­éŸ³æ’­æŠ¥ï¼ˆå¯é€‰ï¼Œä½†å¯ç”¨"å°é¸­è¯­éŸ³"åŠŸèƒ½éœ€å®‰è£…ï¼‰

## å¸¸è§é—®é¢˜

### Q: æ¸¸æˆå¯åŠ¨å¤±è´¥ï¼Ÿ

A: è¯·æ£€æŸ¥ï¼š
1. Python ç‰ˆæœ¬æ˜¯å¦ä¸º 3.7 æˆ–æ›´é«˜
2. æ˜¯å¦å·²å®‰è£…æ‰€æœ‰ä¾èµ–åŒ…ï¼š`pip install -r requirements.txt`
3. æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼Œæ ¹æ®æç¤ºè§£å†³é—®é¢˜

### Q: AI å¯¹è¯åŠŸèƒ½ä¸å¯ç”¨ï¼Ÿ

A: è¯·ç¡®ä¿ï¼š
1. Ollama æœåŠ¡æ­£åœ¨è¿è¡Œï¼š`ollama serve`
2. å·²ä¸‹è½½æ¨¡å‹ï¼š`ollama pull deepseekr1:8b`
3. æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦é˜»æ­¢äº† localhost:11434 ç«¯å£

### Q: ä»£ç ç»Ÿè®¡åŠŸèƒ½æŠ¥é”™ï¼Ÿ

A: è¯·æ£€æŸ¥ï¼š
1. ç›®æ ‡ç›®å½•è·¯å¾„æ˜¯å¦æ­£ç¡®
2. æ˜¯å¦æœ‰è¯»å–æƒé™
3. æ˜¯å¦é€‰æ‹©äº†æœ‰æ•ˆçš„ç¼–ç¨‹è¯­è¨€

## å¼€å‘è¯´æ˜

### é‡æ„è¿›åº¦

é¡¹ç›®æ­£åœ¨è¿›è¡Œæ¶æ„é‡æ„ï¼Œé‡‡ç”¨æ›´æ¨¡å—åŒ–ã€é¢å‘å¯¹è±¡çš„è®¾è®¡ï¼š

- âœ… **é˜¶æ®µ1å®Œæˆ**: æ ¸å¿ƒç³»ç»Ÿæ¨¡å—ï¼ˆGameStateManager, EventManager, RenderSystem, PhysicsSystemï¼‰
- âœ… **é˜¶æ®µ2å®Œæˆ**: çº¢åŒ…æ¸¸æˆæ¨¡å—ç»†åŒ–ï¼ˆRedPacket, Spawner, CollisionDetector, MovementController, Statistics, Renderer, GameManagerï¼‰
- ğŸ”„ **é˜¶æ®µ3è¿›è¡Œä¸­**: UIå±‚æ¨¡å—ï¼ˆé€æ­¥è¿ç§»ã€è§£è€¦ä¸­ï¼‰
- ğŸ”„ **é˜¶æ®µ4è¿›è¡Œä¸­**: æ¸¸æˆä¸»ç±»é‡æ„ï¼ˆ`DuckGame` å·²è¿ç§»åˆ° `game/duck_game.py`ï¼Œ`main.py` ä»…ä½œä¸ºå…¥å£ï¼‰
- â³ **é˜¶æ®µ5å¾…è¿›è¡Œ**: å®Œæ•´æµ‹è¯•å’Œä¼˜åŒ–

### æ‰©å±•åŠŸèƒ½

é¡¹ç›®é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œå¯ä»¥è½»æ¾æ‰©å±•ï¼š

- åœ¨ `game/minigames/` ç›®å½•æ·»åŠ æ–°çš„å°æ¸¸æˆï¼ˆç»§æ‰¿ `BaseMinigame`ï¼‰
- åœ¨ `services/` ç›®å½•æ·»åŠ æ–°çš„æœåŠ¡
- åœ¨ `core/` ç›®å½•æ‰©å±•æ ¸å¿ƒç³»ç»ŸåŠŸèƒ½
- åœ¨ `ui/` ç›®å½•æ·»åŠ æ–°çš„UIç»„ä»¶

### æ·»åŠ æ–°å°æ¸¸æˆ

1. åœ¨ `game/minigames/` åˆ›å»ºæ–°ç›®å½•
2. å®ç° `BaseMinigame` æ¥å£
3. åœ¨ `DuckGame` ä¸­æ³¨å†Œæ–°æ¸¸æˆ

ç¤ºä¾‹ï¼š

```python
from game.minigames.base_minigame import BaseMinigame

class MyNewGame(BaseMinigame):
    def start(self, **kwargs):
        self._active = True
    
    def stop(self):
        self._active = False
    
    def update(self, dt):
        if self._active:
            # æ›´æ–°é€»è¾‘
            pass
    
    def render(self, screen):
        if self._active:
            # æ¸²æŸ“é€»è¾‘
            pass
```

### ä½¿ç”¨äº‹ä»¶ç³»ç»Ÿ

```python
from core.event_system import EventManager, GameEvent

# è®¢é˜…äº‹ä»¶
event_manager.subscribe(GameEvent.RED_PACKET_SPAWNED, lambda packet: print(f"çº¢åŒ…ç”Ÿæˆ: {packet}"))

# å‘å¸ƒäº‹ä»¶
event_manager.emit(GameEvent.RED_PACKET_SPAWNED, packet)
```

### ä½¿ç”¨æ¸²æŸ“ç³»ç»Ÿ

```python
from core.render_system import RenderSystem, RenderLayer

# æ·»åŠ æ¸²æŸ“å™¨
render_system.add_renderer(RenderLayer.GAME_OBJECTS, lambda screen: screen.fill((255, 0, 0)))

# æ¸²æŸ“æ‰€æœ‰å±‚
render_system.render()
```

### è¯­éŸ³æ’­æŠ¥

å°é¸­çš„è¯­éŸ³ç”± `pyttsx3` æä¾›ï¼ˆç¦»çº¿ TTSï¼‰ã€‚å¦‚éœ€å¯ç”¨ï¼Œè¯·ç¡®ä¿æ‰§è¡Œï¼š

```bash
pip install pyttsx3
```

å¦‚æœæœªå®‰è£…æˆ–åˆå§‹åŒ–å¤±è´¥ï¼Œè¯­éŸ³ä¼šè‡ªåŠ¨é™çº§ä¸ºæ–‡æœ¬æç¤ºã€‚

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚

---

**äº«å—æ¸¸æˆï¼** ğŸ¦†ğŸ®
